<!-- templates/auth/profile.html -->
{% extends 'base.html' %}
{% load static %}

{% block title %}الملف الشخصي - مكتبة الكتب{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50 dark:bg-gray-900 py-8 md:py-12">
    <div class="container mx-auto px-4">
        <div class="max-w-7xl mx-auto">
            <!-- رأس الصفحة -->
            <div class="mb-8 mt-20 animate-on-scroll">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h1 class="text-3xl md:text-4xl font-bold text-gray-800 dark:text-white mb-2">الملف الشخصي</h1>
                        <p class="text-lg text-gray-600 dark:text-gray-300">إدارة معلومات حسابك وتفضيلات القراءة</p>
                    </div>
                    <div class="flex items-center space-x-3 space-x-reverse">
                        <div class="relative group">
                            <div class="w-12 h-12 bg-gradient-to-br from-primary-500 to-primary-700 rounded-full flex items-center justify-center shadow-lg transform transition-transform group-hover:scale-110">
                                <span class="text-white font-bold text-lg">{{ user.username|slice:"0:1"|upper }}</span>
                            </div>
                            <div class="absolute -bottom-1 -right-1 w-5 h-5 bg-green-500 border-2 border-white dark:border-gray-900 rounded-full"></div>
                        </div>
                    </div>
                </div>
                
                <!-- شريط التقدم الشخصي -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 mb-6 border border-gray-100 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h3 class="font-bold text-gray-800 dark:text-white">مستوى القارئ</h3>
                            <p class="text-sm text-gray-600 dark:text-gray-300">المبتدئ • المستوى 3</p>
                        </div>
                        <span class="px-3 py-1 bg-gradient-to-r from-yellow-100 to-orange-100 dark:from-yellow-900/30 dark:to-orange-900/30 text-yellow-800 dark:text-yellow-200 rounded-full text-sm font-medium">
                            75% للوصول للمستوى 4
                        </span>
                    </div>
                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                        <div class="bg-gradient-to-r from-yellow-400 to-orange-500 h-2.5 rounded-full" style="width: 75%"></div>
                    </div>
                </div>
            </div>
            
            <div class="flex flex-col lg:flex-row gap-6">
                <!-- الشريط الجانبي -->
                <div class="lg:w-1/4">
                    <div class="sticky top-6 space-y-6">





                        <!-- بطاقة المستخدم -->
                        <div class="bg-white text-gray-300 dark:bg-gray-800 rounded-2xl shadow-lg p-6 border border-gray-100 dark:border-gray-700">
                            <!-- تصميم خلفية متدرجة -->
                            <div class="absolute -top-20 -right-20 w-40 h-40 bg-gradient-to-br from-primary-500/20 to-purple-600/20 rounded-full"></div>
                            <div class="absolute -bottom-20 -left-20 w-40 h-40 bg-gradient-to-br from-blue-500/20 to-teal-600/20 rounded-full"></div>
                            
                            <div class="relative z-10 text-center mb-6">
                                <!-- صورة المستخدم أو الأحرف الأولى -->
                                <div class="w-24 h-24 bg-gradient-to-br from-primary-400 to-primary-600 rounded-full flex items-center justify-center mx-auto mb-4 ring-4 ring-white/20 shadow-lg transform transition-transform hover:scale-105">
                                    {% if user.first_name and user.last_name %}
                                        <span class="text-3xl font-bold text-white">{{ user.first_name|slice:"0:1" }}{{ user.last_name|slice:"0:1" }}</span>
                                    {% else %}
                                        <span class="text-3xl font-bold text-white">{{ user.username|slice:"0:2"|upper }}</span>
                                    {% endif %}
                                </div>
                                <h3 class="font-bold text-xl mb-1">{{ user.username }}</h3>
                                <p class="text-gray-300 text-sm mb-2">{{ user.email }}</p>
                                
                                <!-- معلومات العضوية -->
                                <div class="inline-flex items-center bg-white/10 backdrop-blur-sm rounded-full px-3 py-1 mt-2">
                                    <i class="fas fa-calendar-alt text-xs text-gray-300 ml-1"></i>
                                    <span class="text-xs text-gray-300">عضو منذ {{ user.date_joined|date:"Y/m/d" }}</span>
                                </div>
                            </div>
                            
                            <!-- إحصائيات صغيرة -->
                            <div class="relative z-10 grid grid-cols-2 gap-3 mb-6">
                                <div class="bg-white/10 backdrop-blur-sm rounded-xl p-3 text-center">
                                    <p class="text-xs text-gray-300 mb-1">الكتب</p>
                                    <p class="text-lg font-bold">{{ reading_history_count }}</p>
                                </div>
                                <div class="bg-white/10 backdrop-blur-sm rounded-xl p-3 text-center">
                                    <p class="text-xs text-gray-300 mb-1">المفضلة</p>
                                    <p class="text-lg font-bold">{{ bookmarks_count }}</p>
                                </div>
                            </div>
                            
                            <!-- قائمة التنقل -->
                            <div class="relative z-10 space-y-2">
                                
                                <button class="profile-nav w-full flex items-center justify-between p-3 rounded-xl bg-white/10 hover:bg-white/20 transition-all duration-200 group" data-target="profile-info">
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 bg-gradient-to-br from-blue-500/20 to-blue-600/20 rounded-lg flex items-center justify-center ml-3 group-hover:scale-110 transition-transform">
                                            <i class="fas fa-user-circle text-blue-400"></i>
                                        </div>
                                        <span class="font-medium">المعلومات الشخصية</span>
                                    </div>
                                    <i class="fas fa-chevron-left text-sm text-gray-400 group-hover:text-white transition-colors"></i>
                                </button>
                                
                                <button class="profile-nav w-full flex items-center justify-between p-3 rounded-xl hover:bg-white/10 transition-all duration-200 group" data-target="reading-stats">
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 bg-gradient-to-br from-green-500/20 to-green-600/20 rounded-lg flex items-center justify-center ml-3 group-hover:scale-110 transition-transform">
                                            <i class="fas fa-chart-line text-green-400"></i>
                                        </div>
                                        <span class="font-medium">إحصائيات القراءة</span>
                                    </div>
                                    <i class="fas fa-chevron-left text-sm text-gray-400 group-hover:text-white transition-colors"></i>
                                </button>
                                
                                <button class="profile-nav w-full flex items-center justify-between p-3 rounded-xl hover:bg-white/10 transition-all duration-200 group" data-target="bookmarks">
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 bg-gradient-to-br from-purple-500/20 to-purple-600/20 rounded-lg flex items-center justify-center ml-3 group-hover:scale-110 transition-transform">
                                            <i class="fas fa-bookmark text-purple-400"></i>
                                        </div>
                                        <span class="font-medium">الكتب المحفوظة</span>
                                    </div>
                                    <i class="fas fa-chevron-left text-sm text-gray-400 group-hover:text-white transition-colors"></i>
                                </button>
                                
                                <button class="profile-nav w-full flex items-center justify-between p-3 rounded-xl hover:bg-white/10 transition-all duration-200 group" data-target="reviews">
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 bg-gradient-to-br from-yellow-500/20 to-yellow-600/20 rounded-lg flex items-center justify-center ml-3 group-hover:scale-110 transition-transform">
                                            <i class="fas fa-star text-yellow-400"></i>
                                        </div>
                                        <span class="font-medium">التقييمات</span>
                                    </div>
                                    <i class="fas fa-chevron-left text-sm text-gray-400 group-hover:text-white transition-colors"></i>
                                </button>
                                
                                <button class="profile-nav w-full flex items-center justify-between p-3 rounded-xl hover:bg-white/10 transition-all duration-200 group" data-target="settings">
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 bg-gradient-to-br from-red-500/20 to-red-600/20 rounded-lg flex items-center justify-center ml-3 group-hover:scale-110 transition-transform">
                                            <i class="fas fa-cog text-red-400"></i>
                                        </div>
                                        <span class="font-medium">الإعدادات</span>
                                    </div>
                                    <i class="fas fa-chevron-left text-sm text-gray-400 group-hover:text-white transition-colors"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- بطاقات الإنجازات السريعة -->
                        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 border border-gray-100 dark:border-gray-700">
                            <h3 class="font-bold text-gray-800 dark:text-white mb-6 flex items-center">
                                <i class="fas fa-trophy text-yellow-500 ml-2"></i>
                                إنجازاتك
                            </h3>
                            
                            <div class="space-y-5">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900/40 dark:to-blue-800/40 rounded-xl flex items-center justify-center ml-3 shadow-sm">
                                        <i class="fas fa-book text-blue-600 dark:text-blue-400"></i>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-gray-600 dark:text-gray-300 text-sm">الكتب المقروءة</p>
                                        <h4 class="text-2xl font-bold text-gray-800 dark:text-white">{{ reading_history_count }}</h4>
                                    </div>
                                    <div class="text-green-600 dark:text-green-400">
                                        <i class="fas fa-arrow-up"></i>
                                    </div>
                                </div>
                                
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-gradient-to-br from-green-100 to-green-200 dark:from-green-900/40 dark:to-green-800/40 rounded-xl flex items-center justify-center ml-3 shadow-sm">
                                        <i class="fas fa-bookmark text-green-600 dark:text-green-400"></i>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-gray-600 dark:text-gray-300 text-sm">الكتب المحفوظة</p>
                                        <h4 class="text-2xl font-bold text-gray-800 dark:text-white">{{ bookmarks_count }}</h4>
                                    </div>
                                    <div class="text-green-600 dark:text-green-400">
                                        <i class="fas fa-arrow-up"></i>
                                    </div>
                                </div>
                                
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-gradient-to-br from-yellow-100 to-yellow-200 dark:from-yellow-900/40 dark:to-yellow-800/40 rounded-xl flex items-center justify-center ml-3 shadow-sm">
                                        <i class="fas fa-star text-yellow-600 dark:text-yellow-400"></i>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-gray-600 dark:text-gray-300 text-sm">التقييمات</p>
                                        <h4 class="text-2xl font-bold text-gray-800 dark:text-white">{{ reviews_count }}</h4>
                                    </div>
                                    <div class="text-green-600 dark:text-green-400">
                                        <i class="fas fa-arrow-up"></i>
                                    </div>
                                </div>
                                
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-gradient-to-br from-purple-100 to-purple-200 dark:from-purple-900/40 dark:to-purple-800/40 rounded-xl flex items-center justify-center ml-3 shadow-sm">
                                        <i class="fas fa-clock text-purple-600 dark:text-purple-400"></i>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-gray-600 dark:text-gray-300 text-sm">ساعات القراءة</p>
                                        <h4 class="text-2xl font-bold text-gray-800 dark:text-white">
                                            {% if total_reading_hours %}
                                                {{ total_reading_hours|floatformat:0 }}
                                            {% else %}
                                                0
                                            {% endif %}
                                        </h4>
                                    </div>
                                    <div class="text-green-600 dark:text-green-400">
                                        <i class="fas fa-arrow-up"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- شارات الإنجازات -->
                            <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
                                <h4 class="font-medium text-gray-800 dark:text-white mb-3">شاراتك</h4>
                                <div class="flex space-x-3 space-x-reverse overflow-x-auto pb-2">
                                    <div class="w-10 h-10 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center shadow-md flex-shrink-0">
                                        <i class="fas fa-trophy text-white text-sm"></i>
                                    </div>
                                    <div class="w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center shadow-md flex-shrink-0">
                                        <i class="fas fa-fire text-white text-sm"></i>
                                    </div>
                                    <div class="w-10 h-10 bg-gradient-to-br from-green-400 to-teal-500 rounded-full flex items-center justify-center shadow-md flex-shrink-0">
                                        <i class="fas fa-book-reader text-white text-sm"></i>
                                    </div>
                                    <div class="w-10 h-10 bg-gradient-to-br from-red-400 to-pink-500 rounded-full flex items-center justify-center shadow-md flex-shrink-0">
                                        <i class="fas fa-bolt text-white text-sm"></i>
                                    </div>
                                </div>
                            </div>
                        </div>


                        



                    </div>
                </div>
                
                <!-- المحتوى الرئيسي -->
                <div class="lg:w-3/4">
                    <!-- قسم المعلومات الشخصية -->
                    <div id="profile-info" class="profile-section bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 mb-6 border border-gray-100 dark:border-gray-700">
                        <div class="flex justify-between items-center mb-8">
                            <div>
                                <h3 class="text-2xl font-bold text-gray-800 dark:text-white">المعلومات الشخصية</h3>
                                <p class="text-gray-600 dark:text-gray-300">إدارة بيانات حسابك الأساسية</p>
                            </div>
                            <button id="edit-profile-btn" class="flex items-center text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 font-medium px-4 py-2 rounded-lg hover:bg-primary-50 dark:hover:bg-primary-900/20 transition duration-200">
                                <i class="fas fa-edit ml-2"></i> تعديل الملف
                            </button>
                        </div>
                        
                        <form id="profile-form" method="POST" action="{% url 'profile' %}" class="space-y-8">
                            {% csrf_token %}
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center">
                                        <i class="fas fa-user text-gray-400 ml-2"></i>
                                        اسم المستخدم
                                    </label>
                                    <div class="relative">
                                        <input type="text" value="{{ user.username }}" 
                                               class="w-full p-3 pr-10 border border-gray-300 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-800 dark:text-white" disabled>
                                        <div class="absolute right-3 top-3 text-gray-400">
                                            <i class="fas fa-user-lock"></i>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">لا يمكن تغيير اسم المستخدم</p>
                                </div>
                                
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center">
                                        <i class="fas fa-envelope text-gray-400 ml-2"></i>
                                        البريد الإلكتروني
                                    </label>
                                    <div class="relative">
                                        <input type="email" name="email" value="{{ user.email }}" 
                                               class="w-full p-3 pr-10 border border-gray-300 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white" id="email-input" disabled>
                                        <div class="absolute right-3 top-3 text-gray-400">
                                            <i class="fas fa-at"></i>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center">
                                        <i class="fas fa-signature text-gray-400 ml-2"></i>
                                        الاسم الأول
                                    </label>
                                    <div class="relative">
                                        <input type="text" name="first_name" value="{{ user.first_name|default:'' }}" 
                                               class="w-full p-3 pr-10 border border-gray-300 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white" id="first-name-input" disabled>
                                        <div class="absolute right-3 top-3 text-gray-400">
                                            <i class="fas fa-user-edit"></i>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center">
                                        <i class="fas fa-signature text-gray-400 ml-2"></i>
                                        الاسم الأخير
                                    </label>
                                    <div class="relative">
                                        <input type="text" name="last_name" value="{{ user.last_name|default:'' }}" 
                                               class="w-full p-3 pr-10 border border-gray-300 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white" id="last-name-input" disabled>
                                        <div class="absolute right-3 top-3 text-gray-400">
                                            <i class="fas fa-user-edit"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- تغيير كلمة المرور -->
                            <div class="border-t border-gray-200 dark:border-gray-700 pt-8">
                                <div class="flex items-center justify-between mb-6">
                                    <h4 class="text-lg font-semibold text-gray-800 dark:text-white flex items-center">
                                        <i class="fas fa-key text-primary-500 ml-2"></i>
                                        تغيير كلمة المرور
                                    </h4>
                                    <span class="text-xs text-gray-500 dark:text-gray-400">(اختياري)</span>
                                </div>
                                
                                <div class="space-y-4">
                                    <div class="space-y-2">
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">كلمة المرور الجديدة</label>
                                        <div class="relative">
                                            <input type="password" name="password" 
                                                   class="w-full p-3 pr-10 border border-gray-300 dark:border-gray-600 rounded-xl" id="password-input" disabled
                                                   placeholder="أدخل كلمة مرور جديدة">
                                            <div class="absolute right-3 top-3 text-gray-400">
                                                <i class="fas fa-lock"></i>
                                            </div>
                                            <div class="absolute left-3 top-3 text-gray-400 cursor-pointer" id="toggle-password">
                                                <i class="fas fa-eye"></i>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="space-y-2">
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">تأكيد كلمة المرور</label>
                                        <div class="relative">
                                            <input type="password" 
                                                   class="w-full p-3 pr-10 border border-gray-300 dark:border-gray-600 rounded-xl" id="confirm-password-input" disabled
                                                   placeholder="أعد إدخال كلمة المرور">
                                            <div class="absolute right-3 top-3 text-gray-400">
                                                <i class="fas fa-lock"></i>
                                            </div>
                                            <div class="absolute left-3 top-3 text-gray-400 cursor-pointer" id="toggle-confirm-password">
                                                <i class="fas fa-eye"></i>
                                            </div>
                                        </div>
                                        <div id="password-match" class="hidden text-xs mt-1 text-green-600 dark:text-green-400">
                                            <i class="fas fa-check-circle ml-1"></i>
                                            <span>كلمات المرور متطابقة</span>
                                        </div>
                                        <div id="password-mismatch" class="hidden text-xs mt-1 text-red-600 dark:text-red-400">
                                            <i class="fas fa-exclamation-circle ml-1"></i>
                                            <span>كلمات المرور غير متطابقة</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- أزرار الحفظ والإلغاء -->
                            <div class="flex justify-end space-x-4 space-x-reverse hidden" id="profile-buttons">
                                <button type="button" id="cancel-edit-btn" class="flex items-center bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-semibold py-3 px-6 rounded-xl transition duration-200">
                                    <i class="fas fa-times ml-2"></i> إلغاء
                                </button>
                                <button type="submit" class="flex items-center bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white font-semibold py-3 px-6 rounded-xl transition duration-200 shadow-lg hover:shadow-xl">
                                    <i class="fas fa-save ml-2"></i> حفظ التغييرات
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- قسم إحصائيات القراءة -->
                    <div id="reading-stats" class="profile-section bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 mb-6 border border-gray-100 dark:border-gray-700 hidden">
                        <div class="flex justify-between items-center mb-8">
                            <div>
                                <h3 class="text-2xl font-bold text-gray-800 dark:text-white">إحصائيات القراءة</h3>
                                <p class="text-gray-600 dark:text-gray-300">تتبع تقدمك في القراءة</p>
                            </div>
                            <button class="flex items-center text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 font-medium px-4 py-2 rounded-lg hover:bg-primary-50 dark:hover:bg-primary-900/20 transition duration-200">
                                <i class="fas fa-download ml-2"></i> تصدير الإحصائيات
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-6 rounded-2xl border border-blue-200 dark:border-blue-800/30">
                                <div class="flex items-center justify-between mb-4">
                                    <div>
                                        <p class="text-gray-600 dark:text-gray-300">إجمالي وقت القراءة</p>
                                        <h4 class="text-2xl font-bold text-gray-800 dark:text-white">
                                            {% if total_reading_hours %}
                                                {{ total_reading_hours|floatformat:0 }} ساعة
                                            {% else %}
                                                0 ساعة
                                            {% endif %}
                                        </h4>
                                    </div>
                                    <div class="w-14 h-14 bg-blue-100 dark:bg-blue-900/30 rounded-xl flex items-center justify-center">
                                        <i class="fas fa-clock text-2xl text-blue-600 dark:text-blue-400"></i>
                                    </div>
                                </div>
                                <div class="flex items-center text-green-600 dark:text-green-400 text-sm">
                                    <i class="fas fa-arrow-up ml-1"></i>
                                    <span>15% زيادة عن الشهر الماضي</span>
                                </div>
                            </div>
                            
                            <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 p-6 rounded-2xl border border-green-200 dark:border-green-800/30">
                                <div class="flex items-center justify-between mb-4">
                                    <div>
                                        <p class="text-gray-600 dark:text-gray-300">متوسط الصفحات/يوم</p>
                                        <h4 class="text-2xl font-bold text-gray-800 dark:text-white">24 صفحة</h4>
                                    </div>
                                    <div class="w-14 h-14 bg-green-100 dark:bg-green-900/30 rounded-xl flex items-center justify-center">
                                        <i class="fas fa-file-alt text-2xl text-green-600 dark:text-green-400"></i>
                                    </div>
                                </div>
                                <div class="flex items-center text-green-600 dark:text-green-400 text-sm">
                                    <i class="fas fa-arrow-up ml-1"></i>
                                    <span>8% زيادة عن الشهر الماضي</span>
                                </div>
                            </div>
                            
                            <div class="bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 p-6 rounded-2xl border border-purple-200 dark:border-purple-800/30">
                                <div class="flex items-center justify-between mb-4">
                                    <div>
                                        <p class="text-gray-600 dark:text-gray-300">الكتب المكتملة</p>
                                        <h4 class="text-2xl font-bold text-gray-800 dark:text-white">7 كتب</h4>
                                    </div>
                                    <div class="w-14 h-14 bg-purple-100 dark:bg-purple-900/30 rounded-xl flex items-center justify-center">
                                        <i class="fas fa-check-circle text-2xl text-purple-600 dark:text-purple-400"></i>
                                    </div>
                                </div>
                                <div class="flex items-center text-green-600 dark:text-green-400 text-sm">
                                    <i class="fas fa-arrow-up ml-1"></i>
                                    <span>2 كتب هذا الشهر</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- رسم بياني مبسط -->
                        <div class="bg-gray-50 dark:bg-gray-900/50 p-6 rounded-2xl border border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center mb-6">
                                <h4 class="text-lg font-semibold text-gray-800 dark:text-white">نشاط القراءة الشهري</h4>
                                <div class="flex space-x-2 space-x-reverse">
                                    <button class="px-3 py-1 bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 rounded-lg text-sm font-medium">2024</button>
                                    <button class="px-3 py-1 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg text-sm font-medium">2023</button>
                                </div>
                            </div>
                            <div class="h-48 flex items-end space-x-4 space-x-reverse justify-center" id="reading-chart">
                                {% for i in "123456"|make_list %}
                                <div class="flex flex-col items-center">
                                    <div class="w-8 bg-gradient-to-t from-primary-500 to-primary-400 rounded-t-lg mb-2 transition-all duration-300 hover:h-16" 
                                         style="height: {{ forloop.counter|add:'2' }}px;" 
                                         data-value="{{ forloop.counter|add:'2' }}0"></div>
                                    <span class="text-gray-600 dark:text-gray-400 text-sm">الشهر {{ forloop.counter }}</span>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- قسم التفضيلات -->
                    <div id="settings" class="profile-section bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 border border-gray-100 dark:border-gray-700 hidden">
                        <div class="mb-8">
                            <h3 class="text-2xl font-bold text-gray-800 dark:text-white mb-2">التفضيلات والإعدادات</h3>
                            <p class="text-gray-600 dark:text-gray-300">تخصيص تجربة القراءة الخاصة بك</p>
                        </div>
                        
                        <div class="space-y-8">
                            <!-- إعدادات الإشعارات -->
                            <div class="space-y-4">
                                <h4 class="text-lg font-semibold text-gray-800 dark:text-white">الإشعارات</h4>
                                
                                <div class="flex items-center justify-between p-4 rounded-xl border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-900/50 transition duration-200">
                                    <div class="flex items-center">
                                        <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center ml-4">
                                            <i class="fas fa-envelope text-blue-600 dark:text-blue-400"></i>
                                        </div>
                                        <div>
                                            <h5 class="font-medium text-gray-800 dark:text-white">الإشعارات البريدية</h5>
                                            <p class="text-sm text-gray-600 dark:text-gray-300">تلقي إشعارات عن الكتب الجديدة والعروض</p>
                                        </div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer" checked>
                                        <div class="w-14 h-7 bg-gray-300 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:right-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all dark:border-gray-600 peer-checked:bg-gradient-to-r from-primary-500 to-primary-600"></div>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between p-4 rounded-xl border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-900/50 transition duration-200">
                                    <div class="flex items-center">
                                        <div class="w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center ml-4">
                                            <i class="fas fa-bell text-green-600 dark:text-green-400"></i>
                                        </div>
                                        <div>
                                            <h5 class="font-medium text-gray-800 dark:text-white">إشعارات داخل التطبيق</h5>
                                            <p class="text-sm text-gray-600 dark:text-gray-300">إشعارات حول الأنشطة والتحديثات</p>
                                        </div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer" checked>
                                        <div class="w-14 h-7 bg-gray-300 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:right-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all dark:border-gray-600 peer-checked:bg-gradient-to-r from-primary-500 to-primary-600"></div>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- تفضيلات القراءة -->
                            <div class="space-y-4">
                                <h4 class="text-lg font-semibold text-gray-800 dark:text-white">تفضيلات القراءة</h4>
                                
                                <div class="flex items-center justify-between p-4 rounded-xl border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-900/50 transition duration-200">
                                    <div class="flex items-center">
                                        <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center ml-4">
                                            <i class="fas fa-lightbulb text-purple-600 dark:text-purple-400"></i>
                                        </div>
                                        <div>
                                            <h5 class="font-medium text-gray-800 dark:text-white">التوصيات المخصصة</h5>
                                            <p class="text-sm text-gray-600 dark:text-gray-300">اقتراح كتب بناءً على اهتماماتك</p>
                                        </div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer" checked>
                                        <div class="w-14 h-7 bg-gray-300 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:right-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all dark:border-gray-600 peer-checked:bg-gradient-to-r from-primary-500 to-primary-600"></div>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between p-4 rounded-xl border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-900/50 transition duration-200">
                                    <div class="flex items-center">
                                        <div class="w-12 h-12 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg flex items-center justify-center ml-4">
                                            <i class="fas fa-moon text-yellow-600 dark:text-yellow-400"></i>
                                        </div>
                                        <div>
                                            <h5 class="font-medium text-gray-800 dark:text-white">الوضع المظلم التلقائي</h5>
                                            <p class="text-sm text-gray-600 dark:text-gray-300">تفعيل الوضع المظلم تلقائياً</p>
                                        </div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer" id="dark-mode-toggle">
                                        <input type="checkbox" class="sr-only peer">
                                        <div class="w-14 h-7 bg-gray-300 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:right-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all dark:border-gray-600 peer-checked:bg-gradient-to-r from-primary-500 to-primary-600"></div>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- إعدادات الواجهة -->
                            <div class="space-y-4">
                                <h4 class="text-lg font-semibold text-gray-800 dark:text-white">إعدادات الواجهة</h4>
                                
                                <div class="p-4 rounded-xl border border-gray-200 dark:border-gray-700">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">لغة الواجهة</label>
                                    <div class="flex flex-wrap gap-3">
                                        <button class="px-4 py-2 bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 rounded-lg font-medium border border-primary-200 dark:border-primary-800">العربية</button>
                                        <button class="px-4 py-2 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg font-medium">English</button>
                                        <button class="px-4 py-2 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg font-medium">Français</button>
                                    </div>
                                </div>
                                
                                <div class="p-4 rounded-xl border border-gray-200 dark:border-gray-700">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">حجم الخط</label>
                                    <div class="flex items-center space-x-4 space-x-reverse">
                                        <button class="text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white">
                                            <i class="fas fa-font text-sm"></i>
                                        </button>
                                        <div class="flex-1">
                                            <input type="range" min="12" max="24" value="16" class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                        </div>
                                        <button class="text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white">
                                            <i class="fas fa-font text-xl"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- إجراءات خطيرة -->
                            <div class="border-t border-gray-200 dark:border-gray-700 pt-8">
                                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                                    <div>
                                        <h4 class="font-medium text-gray-800 dark:text-white mb-1">حذف الحساب</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-300">بمجرد حذف حسابك، لا يمكن استعادة بياناتك</p>
                                    </div>
                                    <button id="delete-account-btn" class="flex items-center text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 font-medium px-4 py-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition duration-200 border border-red-200 dark:border-red-800/30">
                                        <i class="fas fa-trash-alt ml-2"></i> حذف الحساب
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- نافذة حذف الحساب -->
<div id="delete-account-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full transform transition-all duration-300 scale-95 opacity-0">
        <div class="p-6">
            <div class="text-center mb-6">
                <div class="w-20 h-20 bg-gradient-to-br from-red-100 to-red-200 dark:from-red-900/30 dark:to-red-800/30 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-exclamation-triangle text-3xl text-red-600 dark:text-red-400"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-2">حذف الحساب</h3>
                <p class="text-gray-600 dark:text-gray-300">هل أنت متأكد من رغبتك في حذف حسابك؟</p>
                <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">هذا الإجراء لا يمكن التراجع عنه. سيتم حذف جميع بياناتك بشكل دائم.</p>
            </div>
            
            <div class="space-y-4 mb-6">
                <div class="p-3 bg-red-50 dark:bg-red-900/20 rounded-lg">
                    <div class="flex items-start">
                        <i class="fas fa-exclamation-circle text-red-600 dark:text-red-400 mt-1 ml-2"></i>
                        <p class="text-sm text-red-700 dark:text-red-300">سيتم حذف: سجل القراءة، الكتب المحفوظة، التقييمات، وجميع البيانات المرتبطة بحسابك.</p>
                    </div>
                </div>
                
                <div class="flex items-center p-3 border border-gray-200 dark:border-gray-700 rounded-lg">
                    <input type="checkbox" id="confirm-delete-checkbox" class="w-5 h-5 text-red-600 bg-gray-100 border-gray-300 rounded focus:ring-red-500 focus:ring-2">
                    <label for="confirm-delete-checkbox" class="mr-3 text-sm text-gray-700 dark:text-gray-300">
                        أفهم أن هذا الإجراء لا يمكن التراجع عنه
                    </label>
                </div>
            </div>
            
            <div class="flex justify-end space-x-4 space-x-reverse">
                <button id="cancel-delete" class="px-6 py-3 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-semibold rounded-xl transition duration-200">
                    إلغاء
                </button>
                <button id="confirm-delete" class="px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-semibold rounded-xl transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    <i class="fas fa-trash-alt ml-2"></i> حذف الحساب
                </button>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
    // تأثيرات GSAP لصفحة الملف الشخصي
    document.addEventListener('DOMContentLoaded', function() {
        // تهيئة الـ dark mode
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        if (darkModeToggle) {
            const savedMode = localStorage.getItem('darkMode') === 'true';
            darkModeToggle.querySelector('input').checked = savedMode;
            
            darkModeToggle.querySelector('input').addEventListener('change', function() {
                const isDark = this.checked;
                localStorage.setItem('darkMode', isDark);
                document.documentElement.classList.toggle('dark', isDark);
            });
        }
        
        // التنقل بين الأقسام
        const profileNavs = document.querySelectorAll('.profile-nav');
        const profileSections = document.querySelectorAll('.profile-section');
        
        function activateSection(targetId) {
            // تحديث الروابط النشطة
            profileNavs.forEach(nav => {
                nav.classList.remove('bg-white/10');
                nav.querySelector('i.fa-chevron-left').classList.remove('text-primary-500', 'text-white');
            });
            
            // إظهار القسم المحدد وإخفاء الآخرين
            profileSections.forEach(section => {
                if (section.id === targetId) {
                    section.classList.remove('hidden');
                    gsap.fromTo(section,
                        { opacity: 0, y: 20 },
                        { opacity: 1, y: 0, duration: 0.5, ease: "power2.out" }
                    );
                } else {
                    section.classList.add('hidden');
                }
            });
        }
        
        profileNavs.forEach(nav => {
            nav.addEventListener('click', function() {
                const targetId = this.getAttribute('data-target');
                this.classList.add('bg-white/10');
                this.querySelector('i.fa-chevron-left').classList.add('text-primary-500');
                activateSection(targetId);
            });
        });
        
        // تفعيل القسم الأول تلقائياً
        if (profileNavs.length > 0) {
            activateSection('profile-info');
            profileNavs[0].classList.add('bg-white/10');
            profileNavs[0].querySelector('i.fa-chevron-left').classList.add('text-primary-500');
        }
        
        // تأثيرات التمرير للروابط الجانبية
        profileNavs.forEach(nav => {
            nav.addEventListener('mouseenter', function() {
                gsap.to(this, {
                    x: -5,
                    duration: 0.2,
                    ease: "power2.out"
                });
            });
            
            nav.addEventListener('mouseleave', function() {
                gsap.to(this, {
                    x: 0,
                    duration: 0.2,
                    ease: "power2.out"
                });
            });
        });
        
        // تفعيل/تعطيل تعديل الملف الشخصي
        const editBtn = document.getElementById('edit-profile-btn');
        const cancelBtn = document.getElementById('cancel-edit-btn');
        const profileButtons = document.getElementById('profile-buttons');
        const editableInputs = ['email-input', 'first-name-input', 'last-name-input', 'password-input', 'confirm-password-input'];
        
        if (editBtn) {
            editBtn.addEventListener('click', function() {
                // تفعيل الحقول
                editableInputs.forEach(id => {
                    const input = document.getElementById(id);
                    if (input) {
                        input.disabled = false;
                        input.classList.remove('bg-gray-50', 'dark:bg-gray-700');
                        input.classList.add('bg-white', 'dark:bg-gray-900');
                        
                        gsap.fromTo(input,
                            { backgroundColor: 'transparent' },
                            { backgroundColor: '#ffffff', duration: 0.3 }
                        );
                    }
                });
                
                // إظهار أزرار الحفظ والإلغاء
                profileButtons.classList.remove('hidden');
                gsap.fromTo(profileButtons,
                    { opacity: 0, y: 20 },
                    { opacity: 1, y: 0, duration: 0.3 }
                );
                
                // إخفاء زر التعديل
                gsap.to(this, {
                    opacity: 0,
                    scale: 0.8,
                    duration: 0.3,
                    onComplete: () => {
                        this.style.display = 'none';
                    }
                });
            });
        }
        
        if (cancelBtn) {
            cancelBtn.addEventListener('click', function() {
                // تعطيل الحقول
                editableInputs.forEach(id => {
                    const input = document.getElementById(id);
                    if (input) {
                        input.disabled = true;
                        input.classList.remove('bg-white', 'dark:bg-gray-900');
                        input.classList.add('bg-gray-50', 'dark:bg-gray-700');
                        
                        gsap.fromTo(input,
                            { backgroundColor: '#ffffff' },
                            { backgroundColor: 'transparent', duration: 0.3 }
                        );
                    }
                });
                
                // إعادة تعيين القيم
                document.getElementById('email-input').value = '{{ user.email }}';
                document.getElementById('first-name-input').value = '{{ user.first_name|default:'' }}';
                document.getElementById('last-name-input').value = '{{ user.last_name|default:'' }}';
                document.getElementById('password-input').value = '';
                document.getElementById('confirm-password-input').value = '';
                
                // إخفاء رسائل التطابق
                document.getElementById('password-match').classList.add('hidden');
                document.getElementById('password-mismatch').classList.add('hidden');
                
                // إخفاء أزرار الحفظ والإلغاء
                gsap.to(profileButtons, {
                    opacity: 0,
                    y: 20,
                    duration: 0.3,
                    onComplete: () => {
                        profileButtons.classList.add('hidden');
                    }
                });
                
                // إظهار زر التعديل
                editBtn.style.display = 'flex';
                gsap.fromTo(editBtn,
                    { opacity: 0, scale: 0.8 },
                    { opacity: 1, scale: 1, duration: 0.3 }
                );
            });
        }
        
        // عرض/إخفاء كلمة المرور
        const togglePassword = document.getElementById('toggle-password');
        const toggleConfirmPassword = document.getElementById('toggle-confirm-password');
        
        if (togglePassword) {
            togglePassword.addEventListener('click', function() {
                const passwordInput = document.getElementById('password-input');
                const icon = this.querySelector('i');
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    passwordInput.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            });
        }
        
        if (toggleConfirmPassword) {
            toggleConfirmPassword.addEventListener('click', function() {
                const confirmInput = document.getElementById('confirm-password-input');
                const icon = this.querySelector('i');
                if (confirmInput.type === 'password') {
                    confirmInput.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    confirmInput.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            });
        }
        
        // التحقق من تطابق كلمة المرور
        const passwordInput = document.getElementById('password-input');
        const confirmPasswordInput = document.getElementById('confirm-password-input');
        const passwordMatch = document.getElementById('password-match');
        const passwordMismatch = document.getElementById('password-mismatch');
        
        function checkPasswordsMatch() {
            if (passwordInput.value && confirmPasswordInput.value) {
                if (passwordInput.value === confirmPasswordInput.value) {
                    passwordMatch.classList.remove('hidden');
                    passwordMismatch.classList.add('hidden');
                    
                    gsap.fromTo([passwordInput, confirmPasswordInput],
                        { borderColor: '#d1d5db' },
                        { borderColor: '#10b981', duration: 0.3 }
                    );
                } else {
                    passwordMatch.classList.add('hidden');
                    passwordMismatch.classList.remove('hidden');
                    
                    gsap.fromTo([passwordInput, confirmPasswordInput],
                        { borderColor: '#d1d5db' },
                        { borderColor: '#ef4444', duration: 0.3 }
                    );
                }
            } else {
                passwordMatch.classList.add('hidden');
                passwordMismatch.classList.add('hidden');
                
                gsap.to([passwordInput, confirmPasswordInput], {
                    borderColor: '#d1d5db',
                    duration: 0.3
                });
            }
        }
        
        if (passwordInput && confirmPasswordInput) {
            passwordInput.addEventListener('input', checkPasswordsMatch);
            confirmPasswordInput.addEventListener('input', checkPasswordsMatch);
        }
        
        // التحكم في نافذة حذف الحساب
        const deleteAccountBtn = document.getElementById('delete-account-btn');
        const deleteModal = document.getElementById('delete-account-modal');
        const cancelDelete = document.getElementById('cancel-delete');
        const confirmDelete = document.getElementById('confirm-delete');
        const confirmCheckbox = document.getElementById('confirm-delete-checkbox');
        const modalContent = deleteModal.querySelector('.bg-white, .bg-gray-800');
        
        function openDeleteModal() {
            deleteModal.classList.remove('hidden');
            gsap.to(deleteModal, {
                opacity: 1,
                duration: 0.3
            });
            
            gsap.to(modalContent, {
                scale: 1,
                opacity: 1,
                duration: 0.4,
                ease: "back.out(1.7)"
            });
        }
        
        function closeDeleteModal() {
            gsap.to(modalContent, {
                scale: 0.95,
                opacity: 0,
                duration: 0.3,
                onComplete: () => {
                    deleteModal.classList.add('hidden');
                    confirmCheckbox.checked = false;
                    confirmDelete.disabled = true;
                }
            });
            
            gsap.to(deleteModal, {
                opacity: 0,
                duration: 0.3
            });
        }
        
        if (deleteAccountBtn) {
            deleteAccountBtn.addEventListener('click', openDeleteModal);
        }
        
        if (cancelDelete) {
            cancelDelete.addEventListener('click', closeDeleteModal);
        }
        
        if (confirmCheckbox) {
            confirmCheckbox.addEventListener('change', function() {
                confirmDelete.disabled = !this.checked;
            });
        }
        
        if (confirmDelete) {
            confirmDelete.addEventListener('click', function() {
                if (!this.disabled) {
                    // إضافة تأثير تحميل
                    const originalHTML = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-spinner fa-spin ml-2"></i> جاري الحذف...';
                    this.disabled = true;
                    
                    // محاكاة طلب AJAX
                    setTimeout(() => {
                        alert('هذه خاصية تجريبية. في الإصدار الكامل سيتم حذف الحساب فعلياً.');
                        this.innerHTML = originalHTML;
                        this.disabled = false;
                        closeDeleteModal();
                    }, 1500);
                }
            });
        }
        
        // إغلاق النافذة عند النقر خارجها
        window.addEventListener('click', function(e) {
            if (e.target === deleteModal) {
                closeDeleteModal();
            }
        });
        
        // تأثيرات على أعمدة الرسم البياني
        const chartBars = document.querySelectorAll('#reading-chart > div');
        chartBars.forEach((bar, index) => {
            const barDiv = bar.querySelector('div');
            barDiv.addEventListener('mouseenter', function() {
                gsap.to(this, {
                    height: '64px',
                    duration: 0.3
                });
            });
            
            barDiv.addEventListener('mouseleave', function() {
                const originalHeight = this.getAttribute('data-value') + 'px';
                gsap.to(this, {
                    height: originalHeight,
                    duration: 0.3
                });
            });
            
            // تأثيرات عند التمرير
            gsap.fromTo(barDiv,
                { height: 0 },
                {
                    height: barDiv.getAttribute('data-value') + 'px',
                    duration: 1,
                    delay: index * 0.1,
                    ease: "power2.out",
                    scrollTrigger: {
                        trigger: '#reading-chart',
                        start: "top 80%",
                        toggleActions: "play none none none"
                    }
                }
            );
        });
        
        // تأثيرات على بطاقات الإحصائيات
        const statCards = document.querySelectorAll('.bg-gradient-to-br');
        statCards.forEach((card, index) => {
            gsap.from(card, {
                opacity: 0,
                y: 20,
                duration: 0.6,
                delay: 0.2 + (index * 0.1),
                scrollTrigger: {
                    trigger: card,
                    start: "top 80%",
                    toggleActions: "play none none none"
                }
            });
        });
        
        // تأثيرات على الأزرار
        const buttons = document.querySelectorAll('button:not(.profile-nav)');
        buttons.forEach(button => {
            button.addEventListener('mouseenter', function() {
                gsap.to(this, {
                    scale: 1.02,
                    duration: 0.2
                });
            });
            
            button.addEventListener('mouseleave', function() {
                gsap.to(this, {
                    scale: 1,
                    duration: 0.2
                });
            });
        });
        
        // تأثيرات التحميل الأولي
        gsap.from('.animate-on-scroll', {
            opacity: 0,
            y: 30,
            duration: 0.8,
            stagger: 0.1,
            ease: "power2.out"
        });
    });
</script>
{% endblock %}
{% endblock %}